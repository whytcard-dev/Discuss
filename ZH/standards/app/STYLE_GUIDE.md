# WhytCard 通用代码风格指南 ## 简介 本文档定义了 WhytCard 项目中使用的所有语言和技术应遵循的通用代码风格和最佳实践。这些标准确保了整个代码库的一致性、可维护性和质量。 ## 目录 1. [基本原则](#fundamental-principles) 2. [命名约定](#naming-conventions) 3. [格式化](#formatting) 4. [文档](#documentation) 5. [代码结构](#code-structure) 6. [特定语言指南](#language-specific-guidelines) 7. [版本控制](#version-control) ## 基本原则 ### 清晰优于巧妙 始终优先考虑代码清晰度，而不是巧妙或复杂的解决方案： - 编写易于理解的代码 - 除非必要，否则避免使用晦涩的语言功能 - 优先考虑可读性和可维护性，而不是简洁性 ### 一致性 在整个代码库中保持一致性： - 遵循项目中既定的模式 - 不要混合不同的风格或方法 - 修改现有代码时，匹配其风格 ### DRY（不要重复自己） 避免代码重复： - 将重复的代码提取到函数或类 - 为常见操作创建共享实用程序 - 使用继承或组合来共享行为 ### KISS（保持简单，愚蠢） 更喜欢简单的解决方案而不是复杂的解决方案： - 从最简单的有效方法开始 - 仅在必要时增加复杂性 - 将复杂问题分解为更简单的部分 ### YAGNI（你不需要它） 不到必要，不要添加功能： - 避免推测性功能 - 仅实现现在需要的功能 - 在需要时重构，而不是抢先重构 ## 命名约定 ### 一般规则 - 名称应具有描述性并传达目的 - 使用完整的单词而不是缩写（常用单词除外） - 与现有的命名模式保持一致 ### 案例样式 为每种语言使用适当的案例样式： - **camelCase**：JavaScript / TypeScript 变量和函数 - **PascalCase**：大多数语言中的类，React 组件 - **snake_case**：Python 变量和函数 - **kebab-case**：HTML 元素，CSS 类，文件名 - **UPPER_SNAKE_CASE**：大多数语言中的常量 ### 命名示例 ```javascript // JavaScript const userProfile = { firstName: &#39;John&#39;, lastName: &#39;Doe&#39;, EMAIL_REGEX: /^[^@]+@[^@]+\.[^@]+$/, }; function calculateTotalPrice(items) { // 实现 } class UserManager { // 实现 } ``` ```python # Python user_profile = { &quot;first_name&quot;: &quot;John&quot;, &quot;last_name&quot;: &quot;Doe&quot;, &quot;EMAIL_REGEX&quot;: r&quot;^[^@]+@[^@]+\.[^@]+$&quot;, } def calculate_total_price(items): # 实现过程 class UserManager: # 实现过程 ``` ## 格式 ### 缩进 - 在整个项目中使用一致的缩进 - 对于 JavaScript/TypeScript/HTML/CSS：2 个空格 - 对于 Python：4 个空格（PEP 8） - 切勿混合使用制表符和空格 ### 行长度 - 对于大多数语言，将行限制为最多 100 个字符 - 对于 Python，请遵循 PEP 8（代码为 79 个字符，注释为 72 个字符） - 以适合语言自然的方式断开长行 ### 间距 - 在运算符周围使用空格 - 在逗号和分号后使用空格 - 使用一致的间距在函数调用和声明中 ### 括号和块 - 大多数语言的左括号都在同一行（Python 函数和类除外） - 即使对于单行块也要一致使用括号 - 将右括号与行首对齐 ### 示例 ```javascript // JavaScript function calculateDiscount(price, discountPercent) { if (price &lt;= 0) { return 0; } const discount = price * (discountPercent / 100); return discount; } const items = [ { name: &#39;Item 1&#39;, price: 10 }, { name: &#39;Item 2&#39;, price: 20 }, { name: &#39;Item 3&#39;, price: 30 }, ]; ``` ```python # Python def calculate_discount(price, discount_percent): if price &lt;= 0: return 0 discount = price * (discount_percent / 100) return discount items = [ {&quot;name&quot;: &quot;Item 1&quot;, &quot;price&quot;: 10}, {&quot;name&quot;: &quot;Item 2&quot;, &quot;price&quot;: 20}, {&quot;name&quot;: &quot;Item 3&quot;, &quot;price&quot;: 30}, ] ``` ## 文档 ### 代码注释 - 使用注释解释“为什么”，而不是“什么” - 注释复杂的算法或非显而易见的解决方案 - 保持注释与代码更改保持同步 - 避免冗余或明显的注释 ### 函数和方法文档 使用以下信息记录所有函数和方法： - 目的描述 - 参数及其类型 - 返回值和类型 - 可能引发的异常 - 复杂函数的使用示例 ### 文件头 在每个文件的开头包含： - 文件目的的简要说明 - 作者信息 - 创建日期 - 许可证信息 ### 例子 ```javascript /** *计算折扣后商品的总价格。**@param {Array<Object> } items - 具有 price 属性的商品对象数组 * @param {number} discountPercent - 折扣百分比（0-100） * @returns {number} 折扣后的总价 * * @example * const items = [{ price: 10 }, { price: 20 }]; * const total = calculateTotalPrice(items, 10); // 返回 27 */ function calculateTotalPrice(items, discountPercent) { // 实现 } ``` ```python def calculate_total_price(items, discount_percent): &quot;&quot;&quot; 计算折扣后商品的总价。 参数： items：带有 price 属性的字典列表 discount_percent：折扣百分比（0-100） 返回： float：折扣后的总价 示例： items = [{&quot;price&quot;: 10}, {&quot;price&quot;: 20}] total = calculate_total_price(items, 10) # 返回 27 &quot;&quot;&quot; # 实现 ``` ## 代码结构 ### 文件组织 - 每个文件一个主要类/组件 - 将相关功能分组放在同一目录中 - 适当时将接口与实现分开 - 保持文件大小合理（指导原则为 &lt; 500 行） ### 函数和方法的大小 - 保持函数和方法小而专注 - 力求函数只做好一件事 - 限制函数长度（指导原则为 &lt; 50 行） -将复杂逻辑提取到辅助函数中 ### 依赖管理 - 最小化模块之间的依赖关系 - 使用依赖注入来减少耦合 - 清晰地记录模块依赖关系 - 避免循环依赖 ### 错误处理 - 在适当的级别处理错误 - 在异常情况下使用异常 - 提供有意义的错误消息 - 没有充分理由不要吞下异常 ## 特定于语言的准则 ### JavaScript/TypeScript - 遵循 Airbnb JavaScript 样式指南 - 在适当的时候使用 ES6+ 功能 - 使用 TypeScript 确保类型安全 - 更喜欢函数式编程模式 ```javascript // 当变量不会被重新分配时，更喜欢使用 const 而不是 let const PI = 3.14159; // 使用模板文字进行字符串插值 const greet = `Hello, ${name}!`; // 使用解构赋值 const { firstName, lastName } = user; // 使用箭头函数进行短回调 const doubled = numbers.map(n =&gt; n * 2); ``` ### Python - 遵循 PEP 8 风格指南 - 使用类型提示（PEP 484） - 对于简单情况，优先使用列表/字典推导 - 使用上下文管理器进行资源管理 ```python # 使用列表推导进行简单转换 doubled = [n * 2 for n in numbers] # 使用上下文管理器进行资源管理 with open(&quot;file.txt&quot;, &quot;r&quot;) as f: content = f.read() # 使用类型提示 def greet(name: str) -&gt; str: return f&quot;Hello, {name}!&quot; ``` ### HTML/CSS - 使用语义 HTML 元素 - 遵循 BEM 方法论进行 CSS 类 - 最小化内联样式 - 使用 CSS 变量进行主题化 ```html <!-- Use semantic HTML --><article class="card"><header class="card__header"><h2 class="card__title">标题</h2></header><div class="card__content"><p>内容在这里</p></div></article>``` ```css /* 使用 CSS 变量进行主题设置 */ :root { --primary-color: #3498db; --secondary-color: #2ecc71; } .card { border: 1px solid var(--primary-color); } /* 遵循 BEM 方法 */ .card__header { background-color: var(--primary-color); } .card__title { font-size: 1.5rem; } ``` ## 版本控制 ### 提交信息 - 编写清晰、描述性的提交信息 - 使用祈使语气（“添加功能”而不是“已添加功能”） - 适用时引用问题编号 - 遵循常规提交格式 ``` feat: 添加用户身份验证系统 - 实现基于 JWT 的身份验证 - 添加登录和注册端点 - 创建身份验证中间件 关闭 #123 ``` ### 分支策略 - 使用功能分支进行新开发 - 保持主分支稳定 - 使用拉取请求进行代码审查 - 合并后删除分支 ### 代码审查 - 合并前审查所有代码 - 关注架构、安全性和性能 - 在评论中保持建设性和尊重性 - 使用自动化工具捕捉样式问题 ## 结论 本样式指南旨在确保 WhytCard 代码库的一致性和质量。虽然它涵盖了一般原则，但有关更详细的规则，请参阅特定于语言的指南。请记住，目标是创建可维护、可读和健壮的代码。所有团队成员都应遵循这些准则，并通过代码审查和指导来帮助执行它们。 --- 最后更新时间：2025-01-15 