# 网络安全标准

## 核心安全原则

- 纵深防御（多层安全）
- 最小特权原则
- 设计和默认安全
- 定期安全测试和审计
- 保持安全依赖项更新
- 安全故障（安全默认值）
- 全面审核（验证每个请求）
- 对所有团队成员进行安全教育

## 身份验证和授权

### 身份验证

- 实施强密码策略
- 最小长度：12 个字符
- 要求包含字符、数字和符号
- 对照常用密码列表检查
- 支持多因素身份验证 (MFA)
- 使用安全会话管理
- 仅限 HTTP 的 Cookie
- HTTPS 的安全标志
- SameSite 属性
- 适当的有效期
- 实施尝试失败后的帐户锁定
- 安全的密码重置流程
- 使用安全的密码存储 (bcrypt/Argon2)
- 考虑无密码选项（WebAuthn、magic链接）

### 授权

- 实施基于角色的访问控制 (RBAC)
- 使用基于属性的访问控制来处理复杂的权限
- 验证每个请求的授权
- 实施适当的访问控制检查
- 使用安全的会话处理
- 实施 API 授权（OAuth 2.0、JWT）
- 避免直接对象引用
- 记录所有访问控制失败

## 数据保护

### 敏感数据

- 识别和分类敏感数据
- 加密静态敏感数据
- 使用 TLS 1.3 传输数据
- 实施适当的密钥管理
- 最大限度地减少敏感数据的收集
- 应用数据最小化原则
- 实施安全的数据删除
- 使用安全存储 API 密钥和机密信息

### 输入验证

- 验证服务器端的所有输入
- 使用参数化查询进行数据库访问
- 实施输入清理
- 验证数据类型、长度和格式是否正确
- 使用允许列表拒绝列表
- 实现上下文相关的输出编码
- 验证文件上传（类型、大小、内容）
- 实现输入速率限制

## 常见漏洞预防

### 注入预防

- 使用参数化查询/预处理语句
- 应用 ORM 并进行适当的转义
- 验证并清理所有输入
- 实现上下文感知的输出编码
- 使用安全的 API 以避免解释器注入

### XSS 预防

- 实现内容安全策略 (CSP)
- 使用自动输出编码
- 应用上下文相关的编码
- 清理 HTML 输入
- 使用内置 XSS 保护的现代框架
- 验证重定向中的 URL
- 对敏感 Cookie 应用 HTTPOnly 标志

### CSRF 预防

- 实现反 CSRF 令牌
- 使用 SameSite Cookie 属性
- 验证来源和引用标头
- 要求对敏感信息进行重新身份验证操作
- 使用正确的 CORS 配置

### 安全标头

- 内容安全策略 (CSP)
- X-Content-Type-Options: nosniff
- 严格传输安全 (HSTS)
- X-Frame-Options
- Referrer-Policy
- Permissions-Policy
- 敏感数据的 Cache-Control 标头
- 注销时清除站点数据

## 基础设施安全

### 服务器安全

- 保持服务器软件更新
- 使用安全的服务器配置
- 实施正确的防火墙规则
- 仅启用 HTTPS（将 HTTP 重定向到 HTTPS）
- 配置正确的 TLS 设置
- 禁用不必要的服务
- 使用以安全为中心的 Web 服务器模块
- 实施速率限制和 DDoS 防护

### API 安全

- 所有 API 端点均使用 HTTPS
- 实施正确的身份验证
- 应用速率限制
- 验证请求有效载荷
- 返回适当的状态代码
- 避免在响应中暴露敏感信息
- 使用 API 密钥进行服务间通信
- 记录 API 使用者的安全要求

### 依赖项管理

- 定期扫描易受攻击的依赖项
- 使用锁定文件固定依赖项版本
- 实施自动化漏洞扫描
- 及时更新依赖项
- 最大限度地减少依赖项使用
- 验证依赖项完整性（校验和）
- 监控供应链攻击
- 制定漏洞响应计划

## 安全测试

### 静态分析

- 实施自动化 SAST 工具
- 在 CI/CD 中集成安全 linting
- 扫描硬编码机密
- 分析代码中的安全反模式
- 验证安全配置
- 检查过时的依赖项
- 执行安全编码标准

### 动态测试

- 定期执行渗透测试
- 实施自动化 DAST 扫描
- 使用交互式应用程序安全测试
- 定期进行漏洞评估
- 测试身份验证和授权流程
- 验证安全标头和配置
- 模拟常见攻击场景

## 安全监控与响应

### 日志记录与监控

- 实施全面的安全日志记录
- 记录身份验证事件
- 记录访问控制失败
- 监控可疑活动
- 实施实时警报
- 使用集中式日志管理
- 确保日志防篡改
- 将日志保留适当的时间段

### 事件响应

- 制定事件响应计划
- 定义角色和职责
- 建立通信协议
- 记录遏制程序
- 实施取证分析能力
- 进行事件后审查
- 演练事件响应场景
- 与安全社区保持联系

## 合规与隐私

### 法规合规

- 确定适用法规（GDPR、CCPA 等）
- 实施所需的安全控制措施
- 进行定期合规性评估
- 记录合规性措施
- 对团队进行合规性要求培训
- 通过以下方式实施隐私设计
- 维护所需文档

### 隐私考虑

- 实施清晰的隐私政策
- 获得数据收集的适当同意
- 提供数据访问和删除机制
- 最大限度地减少数据收集和保留
- 实现数据可移植性
- 进行隐私影响评估
- 在所有设计决策中考虑隐私