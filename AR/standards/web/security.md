# معايير أمان الويب

## مبادئ الأمان الأساسية

- حماية متعمقة (طبقات أمان متعددة)
- مبدأ الحد الأدنى من الامتيازات
- آمن من حيث التصميم والافتراضي
- اختبارات وتدقيق أمني دوري
- تحديث تبعيات الأمان باستمرار
- الفشل الآمن (الافتراضيات الآمنة)
- إتمام الوساطة (التحقق من كل طلب)
- تثقيف أمني لجميع أعضاء الفريق

## المصادقة والتفويض

### المصادقة

- تطبيق سياسات كلمات مرور قوية
- الحد الأدنى للطول: ١٢ حرفًا
- طلب مزيج من الأحرف والأرقام والرموز
- التحقق من قوائم كلمات المرور الشائعة
- دعم المصادقة متعددة العوامل (MFA)
- استخدام إدارة جلسات آمنة
- ملفات تعريف ارتباط HTTP فقط
- علامة أمان لـ HTTPS
- سمة SameSite
- تاريخ انتهاء صلاحية مناسب
- تطبيق قفل الحساب بعد المحاولات الفاشلة
- تدفقات إعادة تعيين كلمة المرور الآمنة
- استخدام تخزين آمن لكلمات المرور (bcrypt/Argon2)
- النظر في خيارات الوصول بدون كلمة مرور (WebAuthn، الروابط السحرية)

### التفويض

- تطبيق التحكم في الوصول القائم على الأدوار (RBAC)
- استخدام التحكم في الوصول القائم على السمات للأذونات المعقدة
- التحقق من صحة التفويض في كل طلب
- تطبيق عمليات فحص مناسبة للتحكم في الوصول
- استخدام معالجة آمنة للجلسات
- تطبيق تفويض واجهة برمجة التطبيقات (OAuth 2.0، JWT)
- تجنب المراجع المباشرة للكائنات
- تسجيل جميع حالات فشل التحكم في الوصول

## حماية البيانات

### البيانات الحساسة

- تحديد البيانات الحساسة وتصنيفها
- تشفير البيانات الحساسة الخاملة
- استخدام TLS 1.3 للبيانات أثناء النقل
- تطبيق إدارة مفاتيح سليمة
- تقليل جمع البيانات الحساسة
- تطبيق مبادئ تقليل البيانات
- تطبيق الحذف الآمن للبيانات
- استخدام التخزين الآمن لمفاتيح وأسرار واجهة برمجة التطبيقات

### التحقق من صحة الإدخالات

- التحقق من صحة جميع المدخلات على جانب الخادم
- استخدام استعلامات ذات معلمات للوصول إلى قاعدة البيانات
- تطبيق تعقيم المدخلات
- التحقق من صحة أنواع البيانات وطولها وتنسيقها
- استخدام قوائم السماح بدلاً من قوائم المنع
- تطبيق ترميز مخرجات خاص بالسياق
- التحقق من صحة تحميلات الملفات (النوع، الحجم، المحتوى)
- تطبيق حد أقصى لمعدلات الإدخال

## منع الثغرات الشائعة

### منع الحقن

- استخدام استعلامات ذات معلمات/عبارات مُجهزة
- تطبيق ORM مع خاصية الإفلات المناسبة
- التحقق من صحة جميع المدخلات وتعقيمها
- تطبيق ترميز مخرجات واعي للسياق
- استخدام واجهات برمجة تطبيقات آمنة تتجنب حقن المُفسّر

### منع XSS

- تطبيق سياسة أمان المحتوى (CSP)
- استخدام ترميز مخرجات تلقائي
- تطبيق ترميز خاص بالسياق
- تعقيم مدخلات HTML
- استخدام أطر عمل حديثة مزودة بحماية XSS مدمجة
- التحقق من صحة عناوين URL في عمليات إعادة التوجيه
- تطبيق علامة HTTPOnly على ملفات تعريف الارتباط الحساسة

### منع CSRF

- تطبيق رموز مكافحة CSRF
- استخدام سمة ملف تعريف ارتباط SameSite
- التحقق من رؤوس المصدر والمرجع
- طلب إعادة المصادقة للإجراءات الحساسة
- استخدام تكوين CORS الصحيح

### رؤوس الأمان

- سياسة أمان المحتوى (CSP)
- خيارات نوع محتوى X: nosniff
- أمان النقل الصارم (HSTS)
- خيارات إطار X
- سياسة المرجع
- سياسة الأذونات
- رؤوس التحكم في ذاكرة التخزين المؤقت للبيانات الحساسة
- مسح بيانات الموقع لتسجيل الخروج

## أمان البنية التحتية

### أمان الخادم

- تحديث برنامج الخادم باستمرار
- استخدام تكوينات خادم آمنة
- تطبيق قواعد جدار الحماية المناسبة
- تفعيل HTTPS فقط (إعادة توجيه HTTP إلى HTTPS)
- تكوين إعدادات TLS المناسبة
- تعطيل الخدمات غير الضرورية
- استخدام وحدات خادم ويب مُركزة على الأمان
- تطبيق تحديد السرعة وحماية DDoS

### أمان واجهة برمجة التطبيقات

- استخدام HTTPS لجميع نقاط نهاية واجهة برمجة التطبيقات
- تطبيق مصادقة مناسبة
- تطبيق تحديد السرعة
- التحقق من صحة حمولات الطلبات
- إرجاع رموز الحالة المناسبة
- تجنب كشف المعلومات الحساسة في الردود
- استخدام مفاتيح واجهة برمجة التطبيقات للتواصل بين الخدمات
- توثيق متطلبات الأمان لمستهلكي واجهة برمجة التطبيقات

### إدارة التبعيات

- فحص التبعيات المعرضة للخطر بانتظام
- استخدام ملفات القفل لتثبيت إصدارات التبعيات
- تطبيق فحص تلقائي للثغرات الأمنية
- تحديث التبعيات فورًا
- تقليل استخدام التبعيات
- التحقق من سلامة التبعيات (مجموعات الاختبار)
- مراقبة هجمات سلسلة التوريد
- وضع خطة استجابة للثغرات الأمنية

## اختبار الأمان

### التحليل الثابت

- تطبيق أدوات SAST الآلية
- دمج فحص الأمان في CI/CD
- فحص الأسرار المُضمنة
- تحليل الكود بحثًا عن أنماط أمنية مضادة
- التحقق من صحة تكوينات الأمان
- التحقق من التبعيات القديمة
- تطبيق معايير الترميز الآمن

### الاختبار الديناميكي

- إجراء اختبارات اختراق دورية
- تطبيق فحص DAST الآلي
- استخدام اختبارات أمان التطبيقات التفاعلية
- إجراء تقييمات دورية للثغرات
- اختبار تدفقات المصادقة والتفويض
- التحقق من رؤوس الأمان والتكوينات
- محاكاة سيناريوهات الهجوم الشائعة

## مراقبة الأمن والاستجابة

### التسجيل والمراقبة

- تطبيق تسجيل أمني شامل
- تسجيل أحداث المصادقة
- تسجيل حالات فشل التحكم في الوصول
- مراقبة الأنشطة المشبوهة
- تطبيق التنبيهات الفورية
- استخدام إدارة السجلات المركزية
- ضمان عدم التلاعب بالسجلات
- الاحتفاظ بالسجلات لـ فترات زمنية مناسبة

### الاستجابة للحوادث

- وضع خطة استجابة للحوادث
- تحديد الأدوار والمسؤوليات
- وضع بروتوكولات اتصال
- إجراءات احتواء الوثائق
- تطبيق قدرات التحليل الجنائي
- إجراء مراجعات ما بعد الحادث
- تطبيق سيناريوهات الاستجابة للحوادث
- الحفاظ على التواصل مع مجتمع الأمن

## الامتثال والخصوصية

### الامتثال للوائح التنظيمية

- تحديد اللوائح المعمول بها (اللائحة العامة لحماية البيانات، وقانون خصوصية المستهلك في كاليفورنيا، إلخ.)
- تطبيق ضوابط الأمن المطلوبة
- إجراء تقييمات امتثال منتظمة
- توثيق تدابير الامتثال
- تدريب الفريق على متطلبات الامتثال
- تطبيق الخصوصية من خلال التصميم
- الاحتفاظ بالوثائق المطلوبة

### اعتبارات الخصوصية

- تطبيق سياسات خصوصية واضحة
- الحصول على الموافقة المناسبة لجمع البيانات
- توفير آليات الوصول إلى البيانات وحذفها
- تقليل جمع البيانات والاحتفاظ بها
- تطبيق قابلية نقل البيانات
- إجراء تقييمات تأثير الخصوصية
- مراعاة الخصوصية في جميع قرارات التصميم 