# Web 性能标准

## 性能目标

- Lighthouse 评分：所有指标均达到 90+
- 核心 Web Vitals 指标：
- LCP（最大内容绘制时间）：< 2.5 秒
- FID（首次输入延迟）：< 100 毫秒
- CLS（累计布局偏移）：< 0.1
- INP（交互到下一次绘制时间）：< 200 毫秒
- 可交互时间：< 3 秒
- 首次内容绘制时间：< 1.8 秒
- 页面总大小：< 1MB（理想情况下 < 500KB）
- HTTP 请求数：每页 < 50 次

## 图片优化

- 使用 WebP/AVIF 格式，并为旧版浏览器提供回退功能
- 使用 `srcset` 和 `sizes` 属性实现响应式图片
- 首屏以下图片延迟加载
- 适当调整图片尺寸（避免通过缩放图片尺寸来提供大尺寸图片） CSS)
- 尽可能使用图片 CDN 进行动态调整大小
- 优化 SVG 并删除不必要的元数据
- 使用 ImageOptim、TinyPNG 或 Squoosh 等工具压缩所有图片
- 考虑使用模糊技术进行渐进式加载

## JavaScript 优化

- 实现代码拆分和动态导入
- 推迟非关键 JavaScript 代码
- 使用 tree-shaking 消除死代码
- 最小化和压缩 JavaScript 文件
- 避免阻塞渲染的 JavaScript
- 使用 Web Worker 执行 CPU 密集型任务
- 实现请求优先级
- 优化第三方脚本并使用 async/defer 属性

## CSS 优化

- 最小化并内联关键 CSS
- 使用 PurgeCSS 等工具删除未使用的 CSS
- 避免 CSS 导入（改用 CSS 连接）
- 对独立组件使用 CSS 容器
- 优化 CSS 选择器以提高性能
- 考虑 CSS-in-JS 的性能影响
- 使用 CSS 变量提高可维护性
- 实现大型应用程序的 CSS 代码拆分

## 字体优化

- 尽可能使用系统字体
- 实现 font-display: swap 或optional
- 子集字体以仅包含必要字符
- 自托管字体，而非使用第三方服务
- 预加载关键字体
- 使用可变字体实现多种字重/样式
- 限制字体变体（字重、样式）

## 缓存策略

- 实施有效的缓存策略
- 静态资源使用长缓存（1 年以上）
- HTML 使用短缓存/无缓存
- 使用版本化文件名或查询字符串进行缓存清除
- 实施 Service Worker 以支持离线
- 使用 localStorage/IndexedDB 进行客户端缓存
- 正确配置 HTTP 缓存标头
- 实施 CDN 缓存

## 服务器优化

- 启用 HTTP/2 或 HTTP/3
- 实施服务器端压缩（Brotli/Gzip）
- 使用 CDN 进行全局内容分发
- 优化 API 响应（分页、字段选择）
- 为动态内容实施边缘计算
- 配置合适的 CORS 设置
- 优化首次字节时间 (TTFB)
- 使用 HTTP 预连接、预获取和预加载提示

## 移动优化

- 优先考虑移动性能（移动优先方法）
- 优化触摸目标（最小 44×44 像素）
- 降低移动设备的网络负载
- 实施响应式设计模式
- 在实际移动设备上进行测试，而不仅仅是模拟器
- 考虑减少动画的动效
- 针对离线/网络连接不良的情况进行优化

## 监控和测试

- 实施真实用户监控 (RUM)
- 为关键用户流设置综合监控
- 使用 WebPageTest 进行详细的性能分析
- 在 Google Search Console 中监控核心 Web 指标
- 设置性能预算和警报
- 定期进行性能审核
- 实施 A/B 测试以改进性能
- 使用 Chrome DevTools 性能面板分析

## 高级技巧

- 实现资源提示（预连接、预加载、预取）
- 使用交叉观察器进行延迟加载
- 考虑服务器端渲染或静态站点生成
- 实现“stale-while-revalidate”模式
- 对非关键任务使用 requestIdleCallback
- 考虑使用导入映射进行模块加载
- 根据用户行为实现预测性预取
- 对关键资源使用优先级提示