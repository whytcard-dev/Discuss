# البنية العامة لمشروع WhytCard

## مقدمة

يقدم هذا المستند البنية العامة لمشروع WhytCard، وهو منصة مفتوحة المصدر لاستخراج بيانات الويب وتدريب الذكاء الاصطناعي. صُممت البنية لتكون معيارية وقابلة للتطوير والصيانة، مما يسمح بإضافة ميزات جديدة بسهولة مع ضمان استقرار النظام.

## نظرة عامة

يعتمد WhytCard على بنية خادم/عميل مع فصل واضح بين الواجهة الأمامية والخلفية. يسمح هذا الفصل بتطوير كلا المكونين بشكل مستقل، ويسهل العمل الجماعي.

```
┌──────────────────┐ ┌───────────────────┐
│ │ │ │
│ الواجهة الأمامية │◄───►│ الواجهة الخلفية │ 
│ (Vue.js) │ │ (FastAPI) │ 
│ │ │ │
└─────────────────┘ └─────────────────┘
▲
│
▼
┌──────────────────┐
│ │
│ كشط البيانات و│
│ خط أنابيب البيانات │
│ │ 
└─────────────────┘ 
▲ 
│ 
▼ 
┌──────────────────┐ 
│ │ 
│ التخزين │ 
│ │ 
└───────────────────┘
```

## الرئيسية المكونات

### 1. الواجهة الأمامية (Vue.js)

طُوّرت الواجهة الأمامية باستخدام Vue.js، وتستخدم Tailwind CSS للتصميم. وهي مسؤولة عن واجهة المستخدم وتجربة المستخدم.

#### الميزات الرئيسية

- **الإطار**: Vue.js 3 مع واجهة برمجة تطبيقات التكوين
- **التصميم**: Tailwind CSS
- **الرسوم المتحركة**: Framer Motion
- **التدويل**: i18next مع الكشف التلقائي عن لغة المتصفح
- **التوجيه**: Vue Router
- **إدارة الحالة**: Pinia

#### الهيكل

```

src/
├── components/ # مكونات قابلة لإعادة الاستخدام
├── config/ # تكوين الواجهة الأمامية
├── i18n/ # ملفات الترجمة
├── router/ # تكوين المسار
├── views/ # الصفحات الرئيسية
└── main.js # نقطة الدخول
```

### 2. الواجهة الخلفية (FastAPI)

تم تطوير الواجهة الخلفية باستخدام FastAPI، وهو إطار عمل بايثون حديث وعالي الأداء لإنشاء واجهات برمجة التطبيقات. يتولى هذا الإطار جميع عمليات الخادم، والوصول إلى البيانات، ومنطق العمل.

#### الميزات الرئيسية

- **إطار العمل**: FastAPI
- **المصادقة**: JWT
- **التحقق**: Pydantic
- **توثيق واجهة برمجة التطبيقات**: واجهة مستخدم Swagger مدمجة

#### الهيكل

```

backend/
├── config/ # تهيئة الواجهة الخلفية
├── core/ # منطق العمل الرئيسي
│ ├── api/ # نقاط نهاية واجهة برمجة التطبيقات
│ └── schemas/ # مخططات Pydantic
├── models/ # نماذج البيانات
├── utils/ # أدوات مساعدة
└── main.py # نقطة الدخول
```

### 3. استخراج البيانات خط الأنابيب

تتولى هذه الوحدة مسؤولية جمع البيانات من مصادر الويب وتحويلها لتدريب نماذج الذكاء الاصطناعي.

#### الميزات الرئيسية

- **الاستخلاص**: نظام غير متزامن مع aiohttp وBeautifulSoup
- **التنسيق**: إدارة المهام والأولوية
- **التحويل**: تنظيف البيانات وتطبيعها
- **التخزين المؤقت**: نظام تخزين مؤقت لتجنب الطلبات المكررة

#### الهيكل

```
الخلفية/
├── الاستخلاص/
│ ├── الاستخلاص/ # تطبيقات محددة لمصادر مختلفة
│ ├── utils/ # أدوات الاستخلاص
│ ├── orchestrator.py # منسق المهام
│ └── cache.py # نظام التخزين المؤقت
└── مجموعات البيانات/ # البيانات المجمعة والمحولة
```

### 4. التخزين

الـ يدير نظام التخزين استمرارية البيانات والوصول إليها. #### خيارات التخزين

- **قاعدة البيانات**: PostgreSQL للبيانات المنظمة
- **تخزين الملفات**: نظام ملفات محلي أو متوافق مع S3 للبيانات الكبيرة
- **ذاكرة التخزين المؤقت**: Redis لذاكرة التخزين المؤقت الموزعة

## تدفق البيانات

### 1. جمع البيانات

```
┌─────────────┐ ┌───────────────┐ ┌───────────────┐
│ │ │ │ │ 
│ الويب │───►│ أدوات الكشط │───►│ ذاكرة التخزين المؤقت │ 
│ المصادر │ │ │ │ 
└─────────────┘ └─────────────┘ └──────────────┘
│
▼ 
┌─────────────┐ ┌─────────────┐ 
│ │ │ │ 
│ المعالجات │───►│ التخزين │ 
│ │ │ │ 
└─────────────┘ └─────────────┘
```

1. تجمع برامج استخراج البيانات البيانات من مصادر الويب.
2. تُخزَّن البيانات مؤقتًا لتجنب الطلبات المكررة.
3. تُنظِّف المعالجات البيانات وتُحوِّلها.
4. تُخزَّن البيانات المُحوَّلة لاستخدامها لاحقًا.

### 2. تدريب النموذج

```
┌────────────┐ ┌──────────────┐ ┌─────────────┐ 
│ │ │ │ │ │ 
│ مجموعات البيانات │───►│ المعالج المسبق │───►│ التدريب │ 
│ │ │ │ │ 
└─────────────┘ └─────────────┘ └────────────┘
│ 
▼ 
┌──────────────┐ 
│ │ 
│ النماذج │ 
│ └─────────────┘
```

1. مجموعات البيانات هي مُستخرج من وحدة التخزين
2. تُعالَج البيانات مُسبقًا للتدريب
3. تُدرَّب النماذج على البيانات المُعالَجة مُسبقًا
4. تُحفَظ النماذج المُدرَّبة

### 3. استخدام النموذج

```
┌──────────────┐ ┌──────────────┐ ┌───────────────┐
│ │ │ │ │
│ واجهة برمجة التطبيقات │────►│ النماذج │───►│ الاستجابة │ 
│ الطلب │ │ │ │ │ └────────────┘ └──────────────┘ └────────────────┘
```

1. تم استلام طلب واجهة برمجة التطبيقات.
2. تم استخدام نماذج مناسبة لمعالجة طلب
3. يتم إنشاء استجابة وإرجاعها.

## التواصل بين المكونات

### واجهة برمجة تطبيقات REST

يتم التواصل بين الواجهة الأمامية والخلفية بشكل أساسي من خلال واجهة برمجة تطبيقات REST. تُنظّم نقاط النهاية منطقيًا وتُوثّق باستخدام واجهة مستخدم Swagger.

### مقابس الويب

بالنسبة للميزات التي تتطلب تحديثات فورية (مثل تتبع مهام الكشط)، تُستخدم مقابس الويب لتمكين الاتصال ثنائي الاتجاه.

### قائمة انتظار الرسائل

بالنسبة للمهام غير المتزامنة وطويلة الأمد، تُستخدم قائمة انتظار رسائل (مثل RabbitMQ أو Redis Pub/Sub) لفصل المكونات وضمان الموثوقية.

## النشر

### خيارات النشر

يمكن نشر WhytCard بعدة طرق:

1. **تطبيق سطح المكتب**: استخدام Tauri لإنشاء تطبيق سطح مكتب متعدد المنصات
2. **النشر السحابي**: النشر على خدمات سحابية مثل AWS أو GCP أو Azure
3. **الاستضافة الذاتية**: التثبيت على خادم شخصي أو خادم شركة

### بنية النشر

```
┌─────────────────┐ ┌──────────────────┐
│ │ │ │ 
│ واجهة المستخدم │◄───►│ بوابة واجهة برمجة التطبيقات │ 
│ (ثابت) │ │ │ 
└────────────────┘ └──────────────────┘ 
▲ 
│ 
▼
┌─────────────────┐ 
│ │ 
│ واجهة برمجة التطبيقات الخلفية │ 
│ │ 
└─────────────────┘ 
▲ 
│ 
▼ 
┌──────────────────┐ ┌──────────────────┐ 
│ │ │ │ 
│ قاعدة البيانات │ │ تخزين الملفات │ 
│ │ │ │ 
└────────────────┘ └───────────────────┘
```

## الأمان

### مبادئ الأمان

1. **الدفاع المتعمق**: طبقات أمان متعددة
2. **مبدأ الحد الأدنى من الامتيازات**: الحد الأدنى من الوصول الضروري
3. **التحقق من صحة المدخلات**: يتم التحقق من صحة جميع مدخلات المستخدم
4. **حماية البيانات**: تشفير البيانات الحساسة

### إجراءات الأمان

- **المصادقة**: JWT مع تدوير الرموز
- **التفويض**: التحكم في الوصول القائم على الأدوار
- **الحماية من الهجمات الشائعة**: XSS، CSRF، حقن SQL
- **التدقيق**: تسجيل الإجراءات المهمة

## قابلية التوسع

صُممت البنية لتكون قابلة للتوسع أفقيًا ورأسيًا:

- **الخدمات المصغرة**: يمكن نشر المكونات بشكل مستقل
- **التخزين المؤقت**: استخدام ذاكرات تخزين مؤقت متعددة المستويات
- **موازنة التحميل**: توزيع حركة البيانات بين مثيلات متعددة
- **التقسيم**: فصل البيانات لتحسين الأداء

## المراقبة وقابلية الملاحظة

- **التسجيل**: تسجيل مركزي باستخدام ELK Stack أو ما يعادله
- **المقاييس**: جمع المقاييس باستخدام Prometheus
- **التتبع**: تتبع الطلبات باستخدام OpenTelemetry
- **التنبيهات**: تنبيهات بناءً على عتبات محددة مسبقًا

## الخلاصة

صُممت بنية WhytCard لتكون متينة وقابلة للتطوير والصيانة. يسمح الفصل الواضح للمسؤوليات بين المكونات المختلفة بالتطور المستقل ويُسهّل العمل الجماعي. اتُخذت خيارات التكنولوجيا مع مراعاة احتياجات المشروع الحالية والمستقبلية، بالإضافة إلى أفضل ممارسات القطاع.

ستتم مراجعة هذه البنية وتحديثها بانتظام للتكيف مع الاحتياجات والتطورات التكنولوجية الجديدة.

---

آخر تحديث: 2025-01-15