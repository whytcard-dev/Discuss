# Стандарти веб-безпеки

## Основні принципи безпеки

- Ешелонований захист (кілька рівнів безпеки)
- Принцип найменших привілеїв
- Безпека за проектом та за замовчуванням
- Регулярне тестування та аудит безпеки
- Оновлення залежностей безпеки
- Безпека у разі збоїв (безпечні налаштування за замовчуванням)
- Повна медіація (перевірка кожного запиту)
- Навчання з питань безпеки для всіх членів команди

## Автентифікація та авторизація

### Автентифікація

- Впровадження політик надійних паролів
- Мінімальна довжина: 12 символів
- Вимагати комбінації символів, цифр, символів
- Перевіряти за поширеними списками паролів
- Підтримка багатофакторної автентифікації (MFA)
- Використовувати безпечне керування сеансами
- Файли cookie лише для HTTP
- Прапор безпеки для HTTPS
- Атрибут SameSite
- Відповідний термін дії
- Впровадження блокування облікового запису після невдалих спроб
- Безпечні процеси скидання пароля
- Використовувати безпечне сховище паролів (bcrypt/Argon2)
- Розгляд безпарольних варіантів (WebAuthn, magic links)

### Авторизація

- Впровадження Контроль доступу на основі ролей (RBAC)
- Використовуйте контроль доступу на основі атрибутів для складних дозволів
- Перевіряйте авторизацію для кожного запиту
- Впроваджуйте належні перевірки контролю доступу
- Використовуйте безпечну обробку сеансів
- Впроваджуйте авторизацію API (OAuth 2.0, JWT)
- Уникайте прямих посилань на об'єкти
- Реєструйте всі збої контролю доступу

## Захист даних

### Конфіденційні дані

- Визначайте та класифікуйте конфіденційні дані
- Шифруйте конфіденційні дані в стані спокою
- Використовуйте TLS 1.3 для даних під час передачі
- Впроваджуйте належне управління ключами
- Мінімізуйте збір конфіденційних даних
- Застосовуйте принципи мінімізації даних
- Впроваджуйте безпечне видалення даних
- Використовуйте безпечне сховище для ключів та секретів API

### Перевірка вхідних даних

- Перевіряйте всі вхідні дані на стороні сервера
- Використовуйте параметризовані запити для доступу до бази даних
- Впроваджуйте санітарну очистку вхідних даних
- Перевіряйте правильність типів даних, довжини, формату
- Використовуйте списки дозволених даних замість списків заборонених
- Впроваджуйте контекстно-залежне кодування виводу
- Перевіряйте файл завантаження (тип, розмір, вміст)
- Реалізація обмеження швидкості для вхідних даних

## Запобігання поширеним вразливостям

### Запобігання ін'єкціям

- Використовуйте параметризовані запити/підготовлені оператори
- Застосовуйте ORM з належним екрануванням
- Перевіряйте та очищуйте всі вхідні дані
- Реалізація контекстно-залежного кодування виводу
- Використовуйте безпечні API, які уникають ін'єкцій інтерпретатора

### Запобігання XSS

- Реалізація Політики безпеки контенту (CSP)
- Використовуйте автоматичне кодування виводу
- Застосовуйте контекстно-залежне кодування
- Очищуйте вхідні дані HTML
- Використовуйте сучасні фреймворки з вбудованим захистом XSS
- Перевіряйте URL-адреси в переадресаціях
- Застосовуйте прапорець HTTPOnly до конфіденційних файлів cookie

### Запобігання CSRF

- Реалізація токенів anti-CSRF
- Використовуйте атрибут файлів cookie SameSite
- Перевіряйте заголовки origin та referrer
- Вимагайте повторної автентифікації для конфіденційних дій
- Використовуйте належну конфігурацію CORS

### Заголовки безпеки

- Content-Security-Policy (CSP)
- X-Content-Type-Options: nosniff 
- Strict-Transport-Security (HSTS) 
- X-Frame-Options 
- Referrer-Policy 
- Permissions-Policy 
- Заголовки Cache-Control для конфіденційних даних 
- Clear-Site-Data для виходу з системи 

## Безпека інфраструктури 

### Безпека сервера 

- Оновлюйте програмне забезпечення сервера 
- Використовуйте безпечні конфігурації сервера 
- Впроваджуйте належні правила брандмауера 
- Увімкніть лише HTTPS (перенаправте HTTP на HTTPS) 
- Налаштуйте належні параметри TLS 
- Вимкніть непотрібні служби 
- Використовуйте модулі веб-сервера, орієнтовані на безпеку 
- Впроваджуйте обмеження швидкості та захист від DDoS-атак 

### Безпека API 

- Використовуйте HTTPS для всіх кінцевих точок API 
- Впроваджуйте належну автентифікацію 
- Застосовуйте обмеження швидкості 
- Перевіряйте корисні навантаження запитів 
- Повертайте відповідні коди стану 
- Уникайте розкриття конфіденційної інформації у відповідях 
- Використовуйте ключі API для зв'язку між службами 
- Документуйте вимоги до безпеки для споживачів API 

### Керування залежностями

- Регулярно сканувати на наявність вразливих залежностей
- Використовувати файли блокування для закріплення версій залежностей
- Впроваджувати автоматичне сканування на вразливості
- Оперативно оновлювати залежності
- Мінімізувати використання залежностей
- Перевіряти цілісність залежностей (контрольні суми)
- Моніторинг атак ланцюга поставок
- Мати план реагування на вразливості

## Тестування безпеки

### Статичний аналіз

- Впроваджувати автоматизовані інструменти SAST
- Інтегрувати лінтинг безпеки в CI/CD
- Сканувати на наявність жорстко закодованих секретів
- Аналізувати код на наявність антишаблонів безпеки
- Перевіряти конфігурації безпеки
- Перевіряти наявність застарілих залежностей
- Забезпечувати дотримання стандартів безпечного кодування

### Динамічне тестування

- Регулярно проводити тестування на проникнення
- Впроваджувати автоматичне сканування DAST
- Використовувати інтерактивне тестування безпеки додатків
- Регулярно проводити оцінку вразливостей
- Тестувати потоки автентифікації та авторизації
- Перевіряти заголовки та конфігурації безпеки
- Моделювати поширені сценарії атак

## Моніторинг та реагування на безпеку

### Журнал та моніторинг

- Впроваджувати комплексний журнал безпеки
- Журналувати автентифікацію події
- Збої контролю доступу до журналів
- Моніторинг підозрілої активності
- Впровадження сповіщень у режимі реального часу
- Використання централізованого управління журналами
- Забезпечення захисту журналів від несанкціонованого доступу
- Зберігання журналів протягом відповідних періодів часу

### Реагування на інциденти

- Розробка плану реагування на інциденти
- Визначення ролей та обов'язків
- Встановлення протоколів зв'язку
- Процедури стримування документів
- Впровадження можливостей судово-медичного аналізу
- Проведення оглядів після інциденту
- Відпрацювання сценаріїв реагування на інциденти
- Підтримка контакту зі спільнотою безпеки

## Відповідність та конфіденційність

### Відповідність нормативним вимогам

- Визначення застосовних нормативних актів (GDPR, CCPA тощо)
- Впровадження необхідних засобів контролю безпеки
- Проведення регулярних оцінок відповідності
- Документування заходів щодо відповідності
- Навчання команди вимогам відповідності
- Впровадження конфіденційності на етапі розробки
- Ведення необхідної документації

### Міркування щодо конфіденційності

- Впровадження чітких політик конфіденційності
- Отримання належної згоди на збір даних
- Забезпечення механізмів доступу до даних та їх видалення
- Мінімізація збору та зберігання даних
- Впровадження переносимості даних
- Проводити оцінки впливу на конфіденційність
- Враховувати конфіденційність у всіх дизайнерських рішеннях