# Webセキュリティ標準

## コアセキュリティ原則

- 多層防御（複数のセキュリティレイヤー）
- 最小権限の原則
- 設計とデフォルトによるセキュリティ確保
- 定期的なセキュリティテストと監査
- セキュリティ依存関係を最新の状態に保つ
- フェイルセキュア（安全なデフォルト設定）
- 完全な仲介（すべてのリクエストを検証）
- チームメンバー全員へのセキュリティ教育

## 認証と承認

### 認証

- 強力なパスワードポリシーを実装する
- 最小文字数：12文字
- 文字、数字、記号の組み合わせを要求する
- 一般的なパスワードリストと照合する
- 多要素認証（MFA）をサポートする
- 安全なセッション管理を使用する
- HTTP専用Cookie
- HTTPSのセキュアフラグ
- SameSite属性
- 適切な有効期限
- 試行失敗後のアカウントロックアウトを実装する
- 安全なパスワードリセットフロー
- 安全なパスワードストレージ（bcrypt/Argon2）を使用する
- パスワードレスオプションを検討する（WebAuthn、マジックリンク）

### 承認

- ロールベースアクセス制御（RBAC）を実装する
- 複雑な権限には属性ベースアクセス制御を使用する
- すべてのリクエストで承認を検証する
- 適切なアクセス制御チェックを実装する
- 安全なセッション処理を使用する
- API承認（OAuth 2.0、JWT）を実装する
- オブジェクトの直接参照を避ける
- すべてのアクセス制御の失敗をログに記録する

## データ保護

### 機密データ

- 機密データを識別および分類する
- 保存中の機密データを暗号化する
- 転送中のデータにはTLS 1.3を使用する
- 適切な鍵管理を実装する
- 機密データの収集を最小限に抑える
- データ最小化の原則を適用する
- 安全なデータ削除を実装する
- APIキーとシークレットには安全なストレージを使用する

### 入力検証

- すべての入力をサーバー側で検証する
- データベースアクセスにはパラメータ化クエリを使用する
- 入力のサニタイズを実装する
- 検証する適切なデータ型、長さ、形式について
- ブラックリストではなくホワイトリストを使用する
- コンテキスト固有の出力エンコーディングを実装する
- ファイルのアップロードを検証する（タイプ、サイズ、コンテンツ）
- 入力のレート制限を実装する

## 共通脆弱性対策

### インジェクション対策

- パラメータ化されたクエリ/プリペアドステートメントを使用する
- 適切なエスケープ処理を施したORMを適用する
- すべての入力を検証し、サニタイズする
- コンテキストに応じた出力エンコーディングを実装する
- インタープリタインジェクションを回避する安全なAPIを使用する

### XSS対策

- コンテンツセキュリティポリシー（CSP）を実装する
- 自動出力エンコーディングを使用する
- コンテキスト固有のエンコーディングを適用する
- HTML入力をサニタイズする
- XSS保護機能が組み込まれた最新のフレームワークを使用する
- リダイレクト内のURLを検証する
- 機密性の高いCookieにHTTPOnlyフラグを適用する

### CSRF対策

- CSRF対策トークンを実装する
- 使用するSameSite Cookie 属性
- オリジンヘッダーとリファラーヘッダーを検証する
- 機密性の高い操作には再認証を要求する
- 適切な CORS 構成を使用する

### セキュリティヘッダー

- Content-Security-Policy (CSP)
- X-Content-Type-Options: nosniff
- Strict-Transport-Security (HSTS)
- X-Frame-Options
- Referrer-Policy
- Permissions-Policy
- 機密データ用の Cache-Control ヘッダー
- ログアウト時に Clear-Site-Data を使用する

## インフラストラクチャセキュリティ

### サーバーセキュリティ

- サーバーソフトウェアを最新の状態に保つ
- 安全なサーバー構成を使用する
- 適切なファイアウォールルールを実装する
- HTTPS のみを有効にする（HTTP を HTTPS にリダイレクトする）
- 適切な TLS 設定を構成する
- 不要なサービスを無効にする
- セキュリティ重視の Web サーバーモジュールを使用する
- レート制限と DDoS 防御を実装する

### APIセキュリティ

- すべてのAPIエンドポイントでHTTPSを使用する
- 適切な認証を実装する
- レート制限を適用する
- リクエストペイロードを検証する
- 適切なステータスコードを返す
- レスポンスで機密情報を公開しないようにする
- サービス間通信にはAPIキーを使用する
- API利用者向けのセキュリティ要件を文書化する

### 依存関係管理

- 脆弱な依存関係を定期的にスキャンする
- ロックファイルを使用して依存関係のバージョンを固定する
- 自動化された脆弱性スキャンを実装する
- 依存関係を迅速に更新する
- 依存関係の使用を最小限に抑える
- 依存関係の整合性（チェックサム）を検証する
- サプライチェーン攻撃を監視する
- 脆弱性対応計画を策定する

## セキュリティテスト

### 静的解析

- 自動化されたSASTツールを実装する
- CI/CDにセキュリティリンティングを統合する
- ハードコードされたシークレットをスキャンする
- セキュリティアンチパターンについてコードを分析する
- セキュリティ構成を検証する
- 古くなった依存関係をチェックする
-安全なコーディング標準の適用

### 動的テスト

- 定期的なペネトレーションテストの実施
- 自動DASTスキャンの実装
- インタラクティブなアプリケーションセキュリティテストの使用
- 定期的な脆弱性評価の実施
- 認証および認可フローのテスト
- セキュリティヘッダーと設定の検証
- 一般的な攻撃シナリオのシミュレーション

## セキュリティ監視と対応

### ログ記録と監視

- 包括的なセキュリティログの実装
- 認証イベントのログ記録
- アクセス制御の失敗のログ記録
- 不審なアクティビティの監視
- リアルタイムアラートの実装
- 一元的なログ管理の使用
- ログの改ざん防止の確保
- 適切な期間のログの保持

### インシデント対応

- インシデント対応計画の策定
- 役割と責任の定義
- コミュニケーションプロトコルの確立
- 封じ込め手順の文書化
- フォレンジック分析機能の実装
- インシデント後のレビューの実施
- インシデント対応シナリオの演習
- セキュリティ担当者との連絡の維持コミュニティ

## コンプライアンスとプライバシー

### 規制コンプライアンス

- 適用される規制（GDPR、CCPAなど）を特定する
- 必要なセキュリティ対策を実装する
- 定期的なコンプライアンス評価を実施する
- コンプライアンス対策を文書化する
- コンプライアンス要件についてチームをトレーニングする
- プライバシー・バイ・デザインを実装する
- 必要なドキュメントを維持する

### プライバシーに関する考慮事項

- 明確なプライバシーポリシーを実装する
- データ収集に関する適切な同意を得る
- データへのアクセスと削除のメカニズムを提供する
- データの収集と保持を最小限に抑える
- データポータビリティを実装する
- プライバシー影響評価を実施する
- すべての設計上の決定においてプライバシーを考慮する