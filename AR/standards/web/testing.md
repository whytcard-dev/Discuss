# معايير اختبار الويب

## فلسفة الاختبار

- الاختبار المبكر والاختبار المتكرر
- أتمتة الاختبارات كلما أمكن
- الاختبار على المستويات المناسبة (الوحدة، التكامل، e2e)
- كتابة اختبارات قابلة للصيانة وموثوقة
- اختبار المسارات الناجحة والحالات الحدية
- استخدام الاختبار لمنع الانحدار
- تحديد أولويات الاختبارات بناءً على تأثيرها على الأعمال
- التعامل مع شيفرة الاختبار بنفس العناية التي نتعامل بها مع شيفرة الإنتاج

## أنواع الاختبارات ونطاق التغطية

### اختبار الوحدات

- **الهدف**: الوظائف والمكونات والوحدات الفردية
- **هدف التغطية**: أكثر من 80% من منطق الأعمال والأدوات المساعدة
- **الأدوات**: Jest، Vitest، مكتبة اختبار React
- **أفضل الممارسات**:
- اتباع نمط AAA (الترتيب، التنفيذ، التأكيد)
- تأكيد واحد لكل اختبار عند الإمكان
- محاكاة التبعيات الخارجية
- اختبار الحالات الحدية وشروط الخطأ
- الاحتفاظ بالاختبارات سريع (أقل من ١٠٠ مللي ثانية لكل اختبار)
- استخدام أسماء اختبارات وصفية
- عزل الاختبارات عن بعضها

### اختبار التكامل

- **الهدف**: التفاعلات بين المكونات والخدمات
- **هدف التغطية**: تدفقات المستخدم الحرجة وتفاعلات المكونات
- **الأدوات**: مكتبة اختبار React، MSW، Supertest
- **أفضل الممارسات**:
- اختبار تركيبات المكونات
- اختبار عمليات إرسال النماذج
- استجابات واجهة برمجة التطبيقات التجريبية
- اختبار تغييرات الحالة
- التحقق من تحديثات DOM
- اختبار التوجيه والتنقل
- استخدام بيانات اختبار واقعية

### الاختبار الشامل

- **الهدف**: إكمال تدفقات المستخدم من واجهة المستخدم إلى الواجهة الخلفية
- **هدف التغطية**: مسارات العمل الحرجة ورحلات المستخدم
- **الأدوات**: Cypress، Playwright
- **أفضل الممارسات**:
- التركيز على المستخدم الحرج الرحلات
- الاختبار على متصفحات متعددة
- استخدام محددات مستقرة (data-testid)
- إعداد بيئات اختبار معزولة
- إدارة بيانات الاختبار بفعالية
- التقاط لقطات شاشة عند الفشل
- تطبيق منطق إعادة المحاولة للاختبارات غير المستقرة

### اختبار الانحدار البصري

- **الهدف**: مظهر واجهة المستخدم وتخطيطها
- **هدف التغطية**: مكونات وصفحات واجهة المستخدم الرئيسية
- **الأدوات**: بيرسي، كروماتيك، بلاي رايت
- **أفضل الممارسات**:
- التقاط لقطات شاشة أساسية
- الاختبار عبر منافذ عرض مختلفة
- تجاهل المحتوى الديناميكي
- مراجعة التغييرات البصرية بعناية
- اختبار أوضاع الإضاءة/الظلام
- الاختبار بأطوال محتوى مختلفة
- التكامل مع خط أنابيب CI/CD

### اختبار إمكانية الوصول

- **الهدف**: التوافق مع WCAG ومشاكل إمكانية الوصول
- **هدف التغطية**: جميع المكونات التي تواجه المستخدم و الصفحات
- **الأدوات**: axe، Lighthouse، WAVE
- **أفضل الممارسات**:
- اختبار التنقل عبر لوحة المفاتيح
- التحقق من توافق قارئ الشاشة
- التحقق من تباين الألوان
- اختبار إدارة التركيز
- التحقق من سمات ARIA
- الاختبار باستخدام التقنيات المساعدة
- أتمتة عمليات التحقق الأساسية من إمكانية الوصول

### اختبار الأداء

- **الهدف**: أوقات تحميل الصفحة، أداء العرض
- **هدف التغطية**: الصفحات الرئيسية ومسارات المستخدم المهمة
- **الأدوات**: Lighthouse، WebPageTest، k6
- **أفضل الممارسات**:
- قياس مؤشرات الويب الحيوية الأساسية
- الاختبار على الأجهزة منخفضة الأداء
- محاكاة خنق الشبكة
- مراقبة حجم الحزمة
- الاختبار باستخدام سيناريوهات تخزين مؤقت واقعية
- قياس الوقت اللازم للتفاعل
- تحديد ميزانيات الأداء

## ممارسات الاختبار

### تنظيم الاختبار

- تجميع الاختبارات منطقيًا حسب الميزة أو المكون
- استخدام أسماء ملفات وصفية وأوصاف اختبار
- فصل أدوات الاختبار والتثبيتات
- تنظيم الاختبارات في تسلسل هرمي يعكس قاعدة الكود
- إبقاء ملفات الاختبار قريبة من الكود الذي تختبره
- استخدام اصطلاحات تسمية متسقة
- فصل اختبارات الوحدة والتكامل والاختبارات الشاملة

### إدارة بيانات الاختبار

- استخدام المصانع أو برامج البناء لبيانات الاختبار
- تجنب بيانات الاختبار المبرمجة مسبقًا
- استخدام بيانات واقعية تتوافق مع أنماط الإنتاج
- إعادة تعيين حالة الاختبار بين الاختبارات
- عزل بيئات الاختبار
- مراعاة خصوصية البيانات في بيانات الاختبار
- استخدام بيانات عشوائية مزروعة للحالات الهامشية

### المحاكاة والمحاكاة البديلة

- محاكاة التبعيات الخارجية (واجهات برمجة التطبيقات، الخدمات)
- استخدام استجابات محاكاة واقعية
- إعادة تعيين المحاكاة بين الاختبارات
- تجنب المحاكاة المفرطة
- المحاكاة على المستوى المناسب
- توثيق سلوك المحاكاة
- استخدام MSW للمحاكاة عبر واجهة برمجة التطبيقات

### التكامل المستمر

- إجراء الاختبارات مع كل طلب سحب
- تنفيذ الاختبارات بالتوازي
- إعداد تقارير الاختبار ولوحات المعلومات
- تهيئة إشعارات فشل الاختبار
- تنفيذ عمليات إعادة المحاولة للاختبارات غير المستقرة
- تخزين تبعيات الاختبار مؤقتًا
- تشغيل أنواع مختلفة من الاختبارات في المراحل المناسبة

## التطوير الموجه بالاختبار (TDD)

- كتابة الاختبارات قبل تطبيق الميزات
- اتباع دورة "الأحمر والأخضر وإعادة الهيكلة"
- البدء بحالات اختبار بسيطة
- إضافة التعقيد تدريجيًا
- استخدام الاختبارات لتحسين التصميم
- إعادة هيكلة الاختبارات مع تطور الكود
- التركيز على السلوك، وليس على التنفيذ

## صيانة الاختبار

- مراجعة الاختبارات وتحديثها بانتظام
- إزالة أو إصلاح الاختبارات غير المستقرة
- إعادة هيكلة الاختبارات مع تغييرات الكود
- مراقبة أداء الاختبار
- تحليل تغطية الاختبار بانتظام
- توثيق استراتيجية الاختبار
- تدريب أعضاء الفريق على ممارسات الاختبار

## الاختبار المتخصص

### اختبار واجهة برمجة التطبيقات

- الاختبار جميع نقاط نهاية واجهة برمجة التطبيقات
- التحقق من مخططات الطلب/الاستجابة
- اختبار المصادقة والتفويض
- اختبار معالجة الأخطاء ورموز الحالة
- التحقق من صحة منطق العمل
- اختبار حدود المعدل والحصص
- توثيق حالات اختبار واجهة برمجة التطبيقات

### اختبار إدارة الحالة

- اختبار انتقالات الحالة
- التحقق من الحالة الأولية
- اختبار مُخفِّضات الحالة والإجراءات
- اختبار المُحدِّدات والحالة المُشتقة
- محاكاة التبعيات الخارجية
- اختبار تغييرات الحالة غير المتزامنة
- التحقق من استمرارية الحالة

### اختبار النماذج

- اختبار عمليات إرسال النماذج
- التحقق من صحة مُدخلات النماذج
- اختبار حالات الأخطاء
- اختبار وظيفة إعادة تعيين النموذج
- اختبار منطق النموذج الشرطي
- التحقق من إمكانية الوصول إلى عناصر النموذج
- اختبار النموذج باستخدام لوحة المفاتيح

### اختبار الأمان

- اختبار تدفقات المصادقة
- التحقق من عمليات التحقق من التفويض
- الاختبار ضد الثغرات الأمنية الشائعة (XSS، CSRF)
- التحقق من صحة المُدخلات التعقيم
- اختبار أمان تحميل الملفات
- التحقق من أمان العناوين
- اختبارها وفقًا لأفضل 10 معايير OWASP