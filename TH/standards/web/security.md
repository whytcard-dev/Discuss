# มาตรฐานความปลอดภัยเว็บ 

## หลักการรักษาความปลอดภัยหลัก 

- การป้องกันเชิงลึก (ชั้นความปลอดภัยหลายชั้น) 
- หลักการของสิทธิ์ขั้นต่ำ 
- การรักษาความปลอดภัยตามการออกแบบและค่าเริ่มต้น 
- การทดสอบและการตรวจสอบความปลอดภัยเป็นประจำ 
- อัปเดตการอ้างอิงด้านความปลอดภัย 
- ล้มเหลวอย่างปลอดภัย (ค่าเริ่มต้นที่ปลอดภัย) 
- ดำเนินการไกล่เกลี่ยให้เสร็จสมบูรณ์ (ตรวจสอบทุกคำขอ) 
- การศึกษาความปลอดภัยสำหรับสมาชิกในทีมทุกคน 

## การรับรองความถูกต้องและการอนุญาต 

### การรับรองความถูกต้อง 

- ใช้หลักนโยบายรหัสผ่านที่แข็งแกร่ง 
- ความยาวขั้นต่ำ: 12 อักขระ 
- ต้องใช้ชุดอักขระ ตัวเลข สัญลักษณ์ 
- ตรวจสอบกับรายการรหัสผ่านทั่วไป 
- รองรับการตรวจสอบความถูกต้องหลายปัจจัย (MFA) 
- ใช้การจัดการเซสชันที่ปลอดภัย 
- คุกกี้ HTTP เท่านั้น 
- แฟล็กความปลอดภัยสำหรับ HTTPS 
- แอตทริบิวต์ SameSite 
- วันหมดอายุที่เหมาะสม 
- ใช้การล็อกบัญชีหลังจากพยายามล้มเหลว 
- ขั้นตอนการรีเซ็ตรหัสผ่านที่ปลอดภัย 
- ใช้การจัดเก็บรหัสผ่านที่ปลอดภัย (bcrypt/Argon2) 
- พิจารณา ตัวเลือกแบบไม่ต้องใช้รหัสผ่าน (WebAuthn, ลิงก์วิเศษ) 

### การอนุญาต 

- นำการควบคุมการเข้าถึงตามบทบาท (RBAC) มาใช้ 
- ใช้การควบคุมการเข้าถึงตามแอตทริบิวต์สำหรับการอนุญาตที่ซับซ้อน 
- ตรวจสอบการอนุญาตในทุกคำขอ 
- นำการตรวจสอบการควบคุมการเข้าถึงที่เหมาะสมมาใช้ 
- ใช้การจัดการเซสชันที่ปลอดภัย 
- นำการอนุญาต API มาใช้ (OAuth 2.0, JWT) 
- หลีกเลี่ยงการอ้างอิงวัตถุโดยตรง 
- บันทึกความล้มเหลวในการควบคุมการเข้าถึงทั้งหมด 

## การปกป้องข้อมูล 

### ข้อมูลที่ละเอียดอ่อน 

- ระบุและจำแนกข้อมูลที่ละเอียดอ่อน 
- เข้ารหัสข้อมูลที่ละเอียดอ่อนที่ไม่ได้ใช้งาน 
- ใช้ TLS 1.3 สำหรับข้อมูลระหว่างการส่ง 
- นำการจัดการคีย์ที่เหมาะสมมาใช้ 
- ลดการรวบรวมข้อมูลที่ละเอียดอ่อนให้เหลือน้อยที่สุด 
- ใช้หลักการลดข้อมูลให้เหลือน้อยที่สุด 
- นำการลบข้อมูลที่ปลอดภัยมาใช้ 
- ใช้ที่เก็บข้อมูลที่ปลอดภัยสำหรับคีย์และความลับของ API 

### การตรวจสอบอินพุต 

- ตรวจสอบอินพุตทั้งหมดบนฝั่งเซิร์ฟเวอร์ 
- ใช้แบบสอบถามแบบพารามิเตอร์สำหรับฐานข้อมูล การเข้าถึง 
- ดำเนินการทำความสะอาดอินพุต 
- ตรวจสอบชนิดข้อมูล ความยาว และรูปแบบที่เหมาะสม 
- ใช้รายการอนุญาตแทนรายการปฏิเสธ 
- ดำเนินการเข้ารหัสเอาต์พุตเฉพาะบริบท 
- ตรวจสอบการอัปโหลดไฟล์ (ชนิด ขนาด เนื้อหา) 
- ดำเนินการจำกัดอัตราสำหรับอินพุต 

## การป้องกันช่องโหว่ทั่วไป 

### การป้องกันการฉีด 

- ใช้แบบสอบถามแบบมีพารามิเตอร์/คำสั่งที่เตรียมไว้ 
- ใช้ ORM ที่มีการหลีกเลี่ยงที่เหมาะสม 
- ตรวจสอบและทำความสะอาดอินพุตทั้งหมด 
- ดำเนินการเข้ารหัสเอาต์พุตที่คำนึงถึงบริบท 
- ใช้ API ที่ปลอดภัยซึ่งหลีกเลี่ยงการฉีดอินเทอร์พรีเตอร์ 

### การป้องกัน XSS 

- ดำเนินการนโยบายการรักษาความปลอดภัยเนื้อหา (CSP) 
- ใช้การเข้ารหัสเอาต์พุตอัตโนมัติ 
- ใช้การเข้ารหัสเฉพาะบริบท 
- ทำความสะอาดอินพุต HTML 
- ใช้กรอบงานที่ทันสมัยพร้อมการป้องกัน XSS ในตัว 
- ตรวจสอบ URL ในการเปลี่ยนเส้นทาง 
- ใช้แฟล็ก HTTPOnly กับคุกกี้ที่ละเอียดอ่อน 

### การป้องกัน CSRF 

- ใช้โทเค็นป้องกัน CSRF 
- ใช้แอตทริบิวต์คุกกี้ SameSite 
- ตรวจสอบส่วนหัวต้นทางและผู้อ้างอิง 
- กำหนดให้ต้องมีการรับรองความถูกต้องอีกครั้งสำหรับการดำเนินการที่ละเอียดอ่อน 
- ใช้การกำหนดค่า CORS ที่เหมาะสม 

### ส่วนหัวความปลอดภัย 

- นโยบายความปลอดภัยของเนื้อหา (CSP) 
- ตัวเลือกประเภทเนื้อหา X: nosniff 
- การรักษาความปลอดภัยการขนส่งอย่างเข้มงวด (HSTS) 
- ตัวเลือกเฟรม X 
- นโยบายผู้อ้างอิง 
- นโยบายการอนุญาต 
- ส่วนหัวการควบคุมแคชสำหรับข้อมูลที่ละเอียดอ่อน 
- ล้างข้อมูลไซต์สำหรับการออกจากระบบ 

## ความปลอดภัยของโครงสร้างพื้นฐาน 

### ความปลอดภัยของเซิร์ฟเวอร์ 

- อัปเดตซอฟต์แวร์เซิร์ฟเวอร์อยู่เสมอ 
- ใช้การกำหนดค่าเซิร์ฟเวอร์ที่ปลอดภัย 
- ใช้กฎไฟร์วอลล์ที่เหมาะสม 
- เปิดใช้งาน HTTPS เท่านั้น (เปลี่ยนเส้นทาง HTTP ไปที่ HTTPS) 
- กำหนดค่าการตั้งค่า TLS ที่เหมาะสม 
- ปิดใช้งานที่ไม่จำเป็น บริการ 
- ใช้โมดูลเซิร์ฟเวอร์เว็บที่เน้นด้านความปลอดภัย 
- ใช้การจำกัดอัตราและการป้องกัน DDoS 

### ความปลอดภัยของ API 

- ใช้ HTTPS สำหรับจุดสิ้นสุดของ API ทั้งหมด 
- ใช้การตรวจสอบสิทธิ์ที่เหมาะสม 
- ใช้การจำกัดอัตรา 
- ตรวจสอบเพย์โหลดคำขอ 
- ส่งรหัสสถานะที่เหมาะสม 
- หลีกเลี่ยงการเปิดเผยข้อมูลที่ละเอียดอ่อนในการตอบกลับ 
- ใช้คีย์ API สำหรับการสื่อสารระหว่างบริการ 
- บันทึกข้อกำหนดด้านความปลอดภัยสำหรับผู้บริโภค API 

### การจัดการการพึ่งพา 

- สแกนการพึ่งพาที่เสี่ยงเป็นประจำ 
- ใช้ล็อกไฟล์เพื่อปักหมุดเวอร์ชันการพึ่งพา 
- ใช้การสแกนช่องโหว่อัตโนมัติ 
- อัปเดตการพึ่งพาทันที 
- ลดการใช้การพึ่งพาให้เหลือน้อยที่สุด 
- ตรวจสอบความสมบูรณ์ของการพึ่งพา (checksum) 
- ตรวจสอบการโจมตีห่วงโซ่อุปทาน 
- มีแผนตอบสนองช่องโหว่ 

## การทดสอบความปลอดภัย 

### การวิเคราะห์แบบสถิต 

- ใช้เครื่องมือ SAST อัตโนมัติ 
- รวมการรักษาความปลอดภัย การตรวจสอบข้อมูลใน CI/CD 
- สแกนหาความลับที่เข้ารหัสแบบฮาร์ดโค้ด 
- วิเคราะห์โค้ดเพื่อหารูปแบบป้องกันความปลอดภัย 
- ตรวจสอบการกำหนดค่าความปลอดภัย 
- ตรวจสอบการอ้างอิงที่ล้าสมัย 
- บังคับใช้มาตรฐานการเข้ารหัสที่ปลอดภัย 

### การทดสอบแบบไดนามิก 

- ดำเนินการทดสอบการเจาะระบบเป็นประจำ 
- ดำเนินการสแกน DAST อัตโนมัติ 
- ใช้การทดสอบความปลอดภัยของแอปพลิเคชันแบบโต้ตอบ 
- ดำเนินการประเมินช่องโหว่เป็นประจำ 
- ทดสอบกระบวนการตรวจสอบสิทธิ์และการอนุญาต 
- ตรวจสอบส่วนหัวและการกำหนดค่าความปลอดภัย 
- จำลองสถานการณ์การโจมตีทั่วไป 

## การตรวจสอบและตอบสนองความปลอดภัย 

### การบันทึกและการตรวจสอบ 

- ดำเนินการบันทึกความปลอดภัยที่ครอบคลุม 
- บันทึกเหตุการณ์การตรวจสอบสิทธิ์ 
- บันทึกความล้มเหลวในการควบคุมการเข้าถึง 
- ตรวจสอบกิจกรรมที่น่าสงสัย 
- ดำเนินการแจ้งเตือนแบบเรียลไทม์ 
- ใช้การจัดการบันทึกแบบรวมศูนย์ 
- ตรวจสอบว่าบันทึกนั้นทนทานต่อการดัดแปลง 
- เก็บบันทึกไว้เป็นระยะเวลาที่เหมาะสม 

### การตอบสนองต่อเหตุการณ์ 

- พัฒนาแผนการตอบสนองต่อเหตุการณ์
- กำหนดบทบาทและความรับผิดชอบ
- กำหนดโปรโตคอลการสื่อสาร
- บันทึกขั้นตอนการกักเก็บ
- นำความสามารถในการวิเคราะห์นิติเวชมาใช้
- ดำเนินการตรวจสอบหลังเกิดเหตุ
- ฝึกปฏิบัติสถานการณ์ตอบสนองต่อเหตุการณ์
- รักษาการติดต่อกับชุมชนด้านความปลอดภัย

## การปฏิบัติตามและความเป็นส่วนตัว

### การปฏิบัติตามกฎระเบียบ

- ระบุกฎระเบียบที่เกี่ยวข้อง (GDPR, CCPA เป็นต้น)
- นำการควบคุมความปลอดภัยที่จำเป็นมาใช้
- ดำเนินการประเมินการปฏิบัติตามกฎระเบียบเป็นประจำ
- บันทึกมาตรการการปฏิบัติตามกฎระเบียบ
- ฝึกอบรมทีมเกี่ยวกับข้อกำหนดการปฏิบัติตามกฎระเบียบ
- นำความเป็นส่วนตัวมาใช้โดยการออกแบบ
- บำรุงรักษาเอกสารที่จำเป็น

### การพิจารณาเรื่องความเป็นส่วนตัว

- นำนโยบายความเป็นส่วนตัวที่ชัดเจนมาใช้
- รับความยินยอมที่เหมาะสมในการรวบรวมข้อมูล
- จัดเตรียมกลไกการเข้าถึงและการลบข้อมูล
- ลดการรวบรวมและเก็บรักษาข้อมูลให้เหลือน้อยที่สุด
- นำความสามารถในการพกพาข้อมูลมาใช้
- ดำเนินการประเมินผลกระทบต่อความเป็นส่วนตัว
- พิจารณาเรื่องความเป็นส่วนตัวในการตัดสินใจออกแบบทั้งหมด