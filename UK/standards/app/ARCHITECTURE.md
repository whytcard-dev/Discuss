# Глобальна архітектура WhytCard

## Вступ

У цьому документі представлено глобальну архітектуру проєкту WhytCard, платформи з відкритим кодом для веб-скрейпінгу та навчання штучному інтелекту. Архітектура розроблена як модульна, масштабована та зручна в обслуговуванні, що дозволяє легко додавати нові функції, забезпечуючи стабільність системи.

## Огляд

WhytCard організовано за клієнт-серверною архітектурою з чітким розділенням між фронтендом та серверною частиною. Таке розділення дозволяє незалежно розвивати обидва компоненти та сприяє командній роботі.

``` 
┌────────────────────┐ ┌───────────────────┐ 
│ │ │ │ 
│ Фронтенд │◄─────►│ Бекенд │ 
│ (Vue.js) │ │ (FastAPI) │ 
│ │ │ │ 
└───────────────────┘ └───────────────────┘ ▲ │ ▼ ┌────────────────────┐ │ │ │ Збір даних та │ │ Конвеєр даних │ │ │ └───────────────────┘ ▲ │ ▼ ┌───────────────────┐ │ │ │ Зберігання │ │ │ └────────────────┘ 
``` 

## Головне Компоненти

### 1. Фронтенд (Vue.js)

Фронтенд розроблено за допомогою Vue.js та використовує Tailwind CSS для стилізації. Він відповідає за користувацький інтерфейс та взаємодію з користувачем.

#### Ключові характеристики

- **Фреймворк**: Vue.js 3 з Composition API
- **Стилізація**: Tailwind CSS
- **Анімації**: Framer Motion
- **Інтернаціоналізація**: i18next з автоматичним визначенням мови браузера
- **Маршрутизація**: Vue Router
- **Керування станом**: Pinia

#### Структура

``` 
src/ 
├── components/ # Компоненти багаторазового використання
├── config/ # Конфігурація фронтенду
├── i18n/ # Файли перекладу
├── router/ # Конфігурація маршруту
├── views/ # Головні сторінки
└── main.js # Точка входу
``` 

### 2. Бекенд (FastAPI)

Бекенд розроблено за допомогою FastAPI, сучасного та Високопродуктивний фреймворк Python для створення API. Він обробляє всі операції сервера, доступ до даних та бізнес-логіку.

#### Ключові характеристики

- **Фреймворк**: FastAPI
- **Автентифікація**: JWT
- **Валідація**: Pydantic
- **Документація API**: Інтегрований інтерфейс Swagger

#### Структура

``` 
backend/ 
├── config/ # Конфігурація backend 
├── core/ # Основна бізнес-логіка 
│ ├── api/ # Кінцеві точки API 
│ └── schemas/ # Схеми Pydantic 
├── models/ # Моделі даних 
├── utils/ # Утиліти 
└── main.py # Точка входу
``` 

### 3. Скрейпінг та конвеєр даних

Цей модуль відповідає за збір даних з веб-джерел та їх перетворення для навчання моделі ШІ.

#### Основні характеристики

- **Скрейпінг**: Асинхронна система з aiohttp та BeautifulSoup
- **Оркестрація**: Керування завданнями та пріоритетами
- **Трансформація**: Очищення та нормалізація даних
- **Кеш**: Система кешування для уникнення надлишкових запитів

#### Структура

``` 
backend/ 
├── скрейпінг/ 
│ ├── скрепери/ # Конкретні реалізації для різних джерел
│ ├── utils/ # Утиліти скрейпінгу
│ ├── orchestrator.py # Оркестратор завдань
│ └── cache.py # Система кешування
└── набори даних/ # Зібрані та перетворені дані
``` 

### 4. Зберігання

Система зберігання керує збереженням даних та доступом до них.

#### Варіанти зберігання

- **База даних**: PostgreSQL для структурованих даних
- **Файлове сховище**: Локальна файлова система або S3-сумісна для великих даних
- **Кеш**: Redis для розподіленого кешу

## Потік даних

### 1. Збір даних

``` 
┌───────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ 
│ │ │ │ │ │ 
│ Веб │────►│ Скрепери │────►│ Кеш │ 
│ Джерела │ │ │ │ │ 
│ Джерела │ │ │ │ 
└─────────────┘ └────────────┘ └────────────┘ └────────────┘ └────────────┘ │ ▼ 
┌─────────────┐ ┌─────────────┐ │ │ │ │ │ Процесори │────►│ Накопичувач │ │ │ │ │ └──────────┘ └─────────────┘ 
``` 

1. Скрепери збирають дані з веб-джерел 
2. Дані кешуються, щоб уникнути надлишкових запитів 
3. Процесори очищують та трансформують дані 
4. Трансформовані дані зберігаються для подальшого використання 

### 2. Навчання моделі 

``` 
┌───────────────┐ ┌─────────────┐ ┌─────────────┐ 
│ │ │ │ │ │ 
│ Набори даних │────►│ Препроцесор│────►│ Навчання │ 
│ │ │ │ │ │ 
│ │ │ │ │ 
└───────────┘ └───────────┘┘ └─────────────┘ 
│ ▼ ┌──────────────┐ │ │ │ Моделі │ │ │ └────────────┘ 
``` 

1. Набори даних витягуються зі сховища
2. Дані попередньо обробляються для навчання
3. Моделі навчаються на попередньо оброблених даних
4. Навчені моделі зберігаються

### 3. Модель Використання 

``` 
┌──────────────┐ ┌─────────────┐ ┌────────────┐ ┌────────────┐ 
│ │ │ │ │ │ 
│ API │────►│ Моделі │────►│ Відповідь │ 
│ Запит │ │ │ │ │ 
└─────────────┘ └────────────┘ └────────────┘ └────────────┘ 
``` 

1. Отримано запит API

2. Для обробки запиту використовуються відповідні моделі

3. Генерується та повертається відповідь

## Зв'язок між компонентами

### REST API

Зв'язок між фронтендом та бекендом здійснюється переважно через REST API. Кінцеві точки логічно організовані та задокументовані за допомогою Swagger UI.

### Вебсокети

Для функцій, що потребують оновлень у режимі реального часу (таких як завдання відстеження парсингу), використовуються вебсокети для забезпечення двонаправленого зв'язку.

### Черга повідомлень

Для асинхронних та тривало виконуваних завдань використовується черга повідомлень (наприклад, RabbitMQ або Redis Pub/Sub) для роз'єднання компонентів та забезпечення надійності.

## Розгортання 

### Варіанти розгортання 

WhytCard можна розгорнути кількома способами:

1. **Настільний застосунок**: Використання Tauri для створення кросплатформного настільного застосунку
2. **Хмарне розгортання**: Розгортання на хмарних сервісах, таких як AWS, GCP або Azure
3. **Самостійне розміщення**: Встановлення на особистому або корпоративному сервері

### Архітектура розгортання

``` 
┌────────────────────┐ ┌──────────────────┐ 
│ │ │ │ 
│ Фронтенд │◄─────►│ Шлюз API │ 
│ (Статичний) │ │ │ 
└───────────────────┘ └────────────────┘ │ ▼ 
┌───────────────────┐ │ │ │ API серверної частини │ │ │ └────────────────┘ ▲ │ ▼ ┌───────────────────┐ ┌──────────────────┐ │ │ │ │ │ База даних │ │ Зберігання файлів │ │ │ │ │ └───────────────┘ └──────────────┘ 
``` 

## Безпека

### Принципи безпеки

1. **Ешелонований захист**: Кілька рівнів безпеки

2. **Принцип найменших привілеїв**: Мінімально необхідний доступ

3. **Перевірка введених даних**: Усі введені користувачем дані перевіряються

4. **Захист даних**: Шифрування конфіденційних даних

### Заходи безпеки

- **Автентифікація**: JWT з ротацією токенів
- **Авторизація**: Контроль доступу на основі ролей
- **Захист від поширених атак**: XSS, CSRF, SQL-ін'єкції
- **Аудит**: Реєстрація важливих дій

## Масштабованість

Архітектура розроблена для горизонтальної та вертикальної масштабованості:

- **Мікросервіси**: Компоненти можна розгортати незалежно
- **Кешування**: Використання багаторівневих кешів
- **Балансування навантаження**: Розподіл трафіку між кількома екземплярами
- **Розділення**: Розділення даних для покращення продуктивності

## Моніторинг та спостереження

- **Реєстрація**: Централізована реєстрація за допомогою ELK Стек або еквівалент
- **Метрики**: Збір метрик за допомогою Prometheus
- **Трасування**: Відстеження запитів за допомогою OpenTelemetry
- **Сповіщення**: Сповіщення на основі попередньо визначених порогів

## Висновок

Архітектура WhytCard розроблена як надійна, масштабована та зручна в обслуговуванні. Чіткий розподіл обов'язків між різними компонентами дозволяє незалежну еволюцію та сприяє командній роботі. Вибір технологій було зроблено з урахуванням поточних та майбутніх потреб проекту, а також передового галузевого досвіду.

Ця архітектура буде регулярно переглядатися та оновлюватися для адаптації до нових потреб та технологічних розробок.

---

Останнє оновлення: 15.01.2025